/**
 Express.js â€“ Middleware, next(), aur express.Router() (Beginner Friendly Notes)

==================================================
ğŸ”¹ Sabse pehle samjho: Middleware kya hota hai?

Middleware = beech ka kaam  
Client request bhejta hai aur response milne ke beech me jo function chalta hai,
use middleware kehte hain.

ğŸ‘‰ Middleware ye kaam kar sakta hai:
- request check karna
- auth verify karna
- data modify karna
- ya request ko next step pe bhejna

Middleware ka structure:
(req, res, next)

--------------------------------------------------
ğŸ”¹ next() kya hota hai? (Bahut IMPORTANT)

- next() ek function hota hai
- Ye Express ko bolta hai:
  ğŸ‘‰ "Is middleware ka kaam ho gaya, ab next matching route/middleware pe jao"

âš ï¸ Agar next() call NAHI kiya:
- request wahi pe atak jaati hai
- aage ka route kabhi execute nahi hota

--------------------------------------------------
ğŸ”¹ Example 1 â€“ next() ke bina problem kya hoti hai?

import express from "express";
const app = express();

app.use("/user", (req, res) => {
  console.log("Middleware 1 executed");
  // next() nahi likha âŒ
});

app.get("/user/profile", (req, res) => {
  res.send("User Profile");
});

Request:
GET /user/profile

Execution flow:
1) Request aayi /user/profile
2) Express top se check karega
3) app.use("/user") mila
4) Prefix match hua "/user" â†’ "/user/profile" âœ…
5) Middleware execute hua
6) next() nahi mila âŒ
7) Request yahi ruk gayi
8) app.get("/user/profile") kabhi execute nahi hua

Result:
âŒ Browser loading / no response

ğŸ‘‰ Problem:
Middleware ne request ko aage jaane hi nahi diya

--------------------------------------------------
ğŸ”¹ Example 2 â€“ next() ke saath SAME code (Problem solved)

import express from "express";
const app = express();

app.use("/user", (req, res, next) => {
  console.log("Middleware 1 executed");
  next(); // âœ… aage jaane ki permission
});

app.get("/user/profile", (req, res) => {
  res.send("User Profile");
});

Request:
GET /user/profile

Execution flow:
1) Request aayi /user/profile
2) app.use("/user") prefix match hua âœ…
3) Middleware execute hua
4) next() call hua
5) Express next route check karega
6) app.get("/user/profile") exact match hua âœ…
7) Response send ho gaya

Output:
User Profile

--------------------------------------------------
ğŸ”¹ Ab samjho: express.Router() kya hota hai?

Router = mini Express app  
- Code ko **alag-alag files** me divide karne ke liye
- Clean code, scalable project ke liye
- Same prefix ke routes ek jagah rakhne ke liye

--------------------------------------------------
ğŸ”¹ Router ke bina problem kya hoti hai?

âŒ Sab routes ek hi file me
âŒ File bahut badi ho jati hai
âŒ Maintain karna mushkil
âŒ Real-world project me bad practice

Example (Router ke bina):

import express from "express";
const app = express();

app.get("/user", handler);
app.get("/user/profile", handler);
app.post("/user/login", handler);
app.delete("/user/:id", handler);

ğŸ‘‰ Jaise-jaise project badhega, file aur gandi hoti jayegi

--------------------------------------------------
ğŸ”¹ Router ke saath solution (Clean & Professional)

user.routes.js
----------------
import express from "express";
const router = express.Router();

router.get("/", (req, res) => {
  res.send("All users");
});

router.get("/profile", (req, res) => {
  res.send("User profile");
});

export default router;

server.js
----------
import express from "express";
import userRouter from "./user.routes.js";

const app = express();

app.use("/user", userRouter);

--------------------------------------------------
ğŸ”¹ Router + prefix + next() ka combined dry run

Request:
GET /user/profile

Execution flow:
1) Express app.use("/user", userRouter) dekhega
2) Prefix "/user" match hua "/user/profile" se âœ…
3) Control router ke paas chala gaya
4) Router ke andar "/profile" route mila
5) router.get("/profile") exact match hua
6) Response send ho gaya

Output:
User profile

--------------------------------------------------
ğŸ”¹ Router use karne ke fayde (Beginner points)

1ï¸âƒ£ Code clean & readable
2ï¸âƒ£ Same prefix ke routes ek file me
3ï¸âƒ£ Easy debugging
4ï¸âƒ£ Real-world industry standard
5ï¸âƒ£ Team work ke liye best

--------------------------------------------------
 FINAL SUPER SIMPLE CONCLUSION

- app.use() = prefix-based, middleware ke liye
- app.get()/post() = exact match, final response ke liye
- next() = request ko aage badhane ki permission
- Router = routes ko organize karne ka professional tareeqa
- Express hamesha top-to-bottom routes check karta hai
*/


====================Express Middleware Chaining Execution Rules==============
/**
====================================================
 Express.js â€“ Real World Flow (Middleware Chain + Router + Folder Structure)
(Beginner to Production Level Notes)
====================================================

----------------------------------------------------
ğŸ”¹ Step 1: Middleware Chain ka matlab kya hota hai?

Middleware Chain = ek ke baad ek multiple middleware ka chalna

Example real life:
Auth check â†’ Data validate â†’ Final response

Express me:
Request â†’ middleware1 â†’ middleware2 â†’ middleware3 â†’ response

âš ï¸ Rule:
- Har middleware ko ya to
  ğŸ‘‰ res.send() se response dena hoga
  ğŸ‘‰ ya next() call karna hoga
- Agar beech me next() nahi mila â†’ request wahi ruk jayegi

----------------------------------------------------
ğŸ”¹ Step 2: Real-world example (Auth â†’ Validation â†’ Controller)

Code samajhne se pehle roles samjho:

1ï¸âƒ£ authMiddleware  
ğŸ‘‰ check karega user login hai ya nahi

2ï¸âƒ£ validateMiddleware  
ğŸ‘‰ request ka data sahi hai ya nahi

3ï¸âƒ£ controller  
ğŸ‘‰ final kaam karega (response bhejna)

----------------------------------------------------
ğŸ”¹ Code Example â€“ Middleware Chain

import express from "express";
const app = express();

const authMiddleware = (req, res, next) => {
  console.log("Auth middleware");
  next(); // user authenticated maan liya
};

const validateMiddleware = (req, res, next) => {
  console.log("Validation middleware");
  next(); // data valid maan liya
};

const controller = (req, res) => {
  res.send("Final response from controller");
};

app.get(
  "/profile",
  authMiddleware,
  validateMiddleware,
  controller
);

----------------------------------------------------
ğŸ”¹ Dry Run (VERY IMPORTANT)

Request:
GET /profile

Execution flow:
1) Request aayi /profile
2) Express route match hua
3) Sabse pehle authMiddleware chala
4) authMiddleware ne next() call kiya
5) validateMiddleware chala
6) validateMiddleware ne next() call kiya
7) controller execute hua
8) res.send() hua
9) Response close

Output:
Final response from controller

----------------------------------------------------
ğŸ”¹ Agar beech me next() hata do to kya hoga?

Example:
const authMiddleware = (req, res, next) => {
  console.log("Auth middleware");
  // next() nahi likha âŒ
};

Result:
- request wahi pe atak jayegi
- validateMiddleware aur controller kabhi nahi chalenge
- browser me loading hi dikhegi

----------------------------------------------------
ğŸ”¹ Step 3: app.use("/api", router) ka real meaning

Sabse pehle PREFIX samjho:

PREFIX = common starting path

Example:
"/api" ek prefix hai

----------------------------------------------------
ğŸ”¹ Router setup (Industry style)

routes/user.routes.js
---------------------
import express from "express";
const router = express.Router();

router.get("/profile", (req, res) => {
  res.send("User profile");
});

router.get("/settings", (req, res) => {
  res.send("User settings");
});

export default router;

server.js
---------
import express from "express";
import userRouter from "./routes/user.routes.js";

const app = express();

app.use("/api/user", userRouter);

----------------------------------------------------
ğŸ”¹ Deep Dry Run â€“ Router + Prefix

Request:
GET /api/user/profile

Step-by-step:
1) Express app.use("/api/user", userRouter) dekhega
2) Prefix "/api/user" match hua "/api/user/profile" se âœ…
3) Control router ko de diya gaya
4) Router ke andar "/profile" route check hua
5) router.get("/profile") exact match hua
6) Response send hua

Output:
User profile

----------------------------------------------------
ğŸ”¹ Important beginner confusion clear karo

â“ router.get("/profile") likha hai  
â“ request "/api/user/profile" hai  
â“ match kaise hua?

ğŸ‘‰ Kyunki:
- "/api/user" pehle hi cut ho chuka hota hai
- Router ke andar sirf bacha hua path "/profile" jata hai

----------------------------------------------------
ğŸ”¹ Step 4: Real-World Folder Structure (Beginner Friendly)

project/
â”‚
â”œâ”€â”€ server.js
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ user.routes.js
â”‚
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ user.controller.js
â”‚
â”œâ”€â”€ middlewares/
â”‚   â”œâ”€â”€ auth.middleware.js
â”‚   â””â”€â”€ validate.middleware.js
â”‚
â””â”€â”€ package.json

----------------------------------------------------
ğŸ”¹ Real-world flow summary

Request
â†“
Global middleware (app.use)
â†“
Router prefix match
â†“
Route-level middleware (auth, validation)
â†“
Controller
â†“
Response

----------------------------------------------------
 FINAL GOLDEN RULES

1ï¸âƒ£ Express routes hamesha top-to-bottom check hote hain  
2ï¸âƒ£ app.use() = prefix based + any HTTP method  
3ï¸âƒ£ app.get/post = exact path + exact method  
4ï¸âƒ£ next() = request ko aage badhne ka signal  
5ï¸âƒ£ Router = clean, scalable, professional code  

====================================================
*/

